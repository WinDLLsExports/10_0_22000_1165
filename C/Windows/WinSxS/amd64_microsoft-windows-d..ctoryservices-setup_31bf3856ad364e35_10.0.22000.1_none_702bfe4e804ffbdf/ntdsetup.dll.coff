Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-d..ctoryservices-setup_31bf3856ad364e35_10.0.22000.1_none_702bfe4e804ffbdf\ntdsetup.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdsbsrv.dll
    WLDAP32.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    DSPARSE.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    RPCRT4.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    CRYPT32.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    WS2_32.dll
    logoncli.dll
    DNSAPI.dll
    api-ms-win-core-file-l2-1-2.dll
    netutils.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l1-1-0.dll
    certcli.dll
    LSASRV.dll
    ADVAPI32.dll
    cryptdll.dll
    KERNEL32.dll
    ntdll.dll
    NTDSA.dll
    NTDSAPI.dll
    SAMSRV.dll
    SHLWAPI.dll

  Section contains the following exports for NTDSETUP.dll

    00000000 characteristics
    11CDF5ED time date stamp
        0.00 version
           1 ordinal base
          24 number of functions
          24 number of names

    ordinal hint RVA      name

          1    0 000184E0 AdamFetchDemotionInfo
          2    1 0000ED40 AdamGetCrossRefs
          3    2 00018920 FreeDemotionInfo
          4    3 00010180 NtdsAdamValidateInst
          5    4 00010610 NtdsAdamValidateServiceAccount
          6    5 00010650 NtdsAdamVerifyBind
          7    6 000192E0 NtdsCheckMachineAccountFlags
          8    7 00019310 NtdsDemote
          9    8 00012500 NtdsFreeDnsRRInfo
         10    9 000194C0 NtdsGetDefaultDnsName
         11    A 00004750 NtdsInstall
         12    B 000194D0 NtdsInstallCancel
         13    C 00019550 NtdsInstallReplicateFull
         14    D 00009890 NtdsInstallShutdown
         15    E 00019760 NtdsInstallUndo
         16    F 000197A0 NtdsPrepareForDemotion
         17   10 000198C0 NtdsPrepareForDemotionUndo
         18   11 000198E0 NtdsPrepareForDsUpgrade
         19   12 00019B50 NtdsSetReplicaMachineAccount
         20   13 00002530 NtdspConfigRegistry
         21   14 000098F0 NtdspDNStoRFC1779Name
         22   15 0001BB90 NtdspFindSite
         23   16 00001190 NtdspValidateInstallParameters
         24   17 00009380 NtdspVerifyDsEnvironment

  Section contains the following imports:

    msvcrt.dll
             180028A98 Import Address Table
             18002F720 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4E6 strtoul
                         488 isxdigit
                         42F bsearch
                         347 _ultow_s
                         473 isdigit
                         188 _i64tow_s
                         518 wcsncmp
                         52D wprintf
                         370 _vsnprintf
                         4E9 swprintf_s
                         47E iswcntrl
                          5E __C_specific_handler
                         1ED _local_unwind
                         49E memcmp
                         49F memcpy
                         4A1 memmove
                         4A3 memset
                         523 wcstok
                         189 _initterm
                          B7 _amsg_exit
                          5A _XcptFilter
                         47D iswascii
                         4F6 tolower
                         416 _wtol
                         1FE _ltow
                         412 _wtoi
                         298 _msize
                         392 _wcsdup
                         4DF strrchr
                         4B1 qsort
                         3A1 _wcsnicmp
                         521 wcsstr
                         1E5 _itow
                         50E wcschr
                         528 wcstoul
                         512 wcscpy_s
                         1E6 _itow_s
                         525 wcstol
                         493 malloc
                         42D atoi
                         459 free
                         397 _wcsicmp
                         376 _vsnwprintf
                         50F wcscmp

    ntdsbsrv.dll
             180028D10 Import Address Table
             18002F998 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 NtdsbsrvDllInit
                           4 UnInstallBackupServices

    WLDAP32.dll
             1800284C0 Import Address Table
             18002F148 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    12
                             Ordinal   155
                             Ordinal   170
                             Ordinal    46
                             Ordinal   145
                             Ordinal   142
                             Ordinal    36
                             Ordinal    14
                             Ordinal    73
                             Ordinal   127
                             Ordinal    97
                             Ordinal    41
                             Ordinal   135
                             Ordinal   167
                             Ordinal   140
                             Ordinal   147
                             Ordinal    16
                             Ordinal    88
                             Ordinal    27
                             Ordinal    26
                             Ordinal    18
                             Ordinal   203
                             Ordinal   206
                             Ordinal    13
                             Ordinal   133
                             Ordinal   161
                             Ordinal    79
                             Ordinal   113
                             Ordinal    21
                             Ordinal   224
                             Ordinal    69
                             Ordinal   208
                             Ordinal   301
                             Ordinal   157

    api-ms-win-core-heap-l2-1-0.dll
             180028690 Import Address Table
             18002F318 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree
                           2 LocalAlloc
                           5 LocalReAlloc

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800285E8 Import Address Table
             18002F270 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 UnhandledExceptionFilter
                           5 GetLastError
                           F SetUnhandledExceptionFilter

    api-ms-win-security-base-l1-1-0.dll
             1800288C8 Import Address Table
             18002F550 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2C EqualSid
                          2E FreeSid
                          3D GetSecurityDescriptorSacl
                          47 InitializeAcl
                          2D FindFirstFreeAce
                           8 AddAccessAllowedAceEx
                          50 MakeSelfRelativeSD
                          4F MakeAbsoluteSD
                          61 SetSecurityDescriptorControl
                          39 GetSecurityDescriptorGroup
                          4D IsValidSid
                          45 ImpersonateLoggedOnUser
                          64 SetSecurityDescriptorOwner
                          3A GetSecurityDescriptorLength
                          48 InitializeSecurityDescriptor
                          63 SetSecurityDescriptorGroup
                          28 DuplicateToken
                          66 SetSecurityDescriptorSacl
                          3B GetSecurityDescriptorOwner
                           D AddAce
                          30 GetAclInformation
                          62 SetSecurityDescriptorDacl
                          16 AllocateAndInitializeSid
                          59 RevertToSelf
                          38 GetSecurityDescriptorDacl
                          2F GetAce
                          37 GetSecurityDescriptorControl
                          35 GetLengthSid

    api-ms-win-core-registry-l1-1-0.dll
             180028758 Import Address Table
             18002F3E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          24 RegQueryValueExA
                          2E RegSetValueExW
                           0 RegCloseKey
                          2D RegSetValueExA
                          1D RegOpenKeyExA
                          1E RegOpenKeyExW
                           B RegDeleteValueW
                          1B RegNotifyChangeKeyValue
                           9 RegDeleteTreeW
                          25 RegQueryValueExW
                           2 RegCreateKeyExA

    DSPARSE.dll
             180028250 Import Address Table
             18002EED8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F DsMakeSpnW

    api-ms-win-core-processthreads-l1-1-0.dll
             180028718 Import Address Table
             18002F3A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          55 TerminateProcess
                           D GetCurrentProcessId
                          11 GetCurrentThreadId
                           C GetCurrentProcess
                           8 ExitProcess

    api-ms-win-service-management-l1-1-0.dll
             1800289C0 Import Address Table
             18002F648 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 DeleteService
                           2 CreateServiceW
                           0 CloseServiceHandle
                           4 OpenSCManagerW
                           5 OpenServiceW

    api-ms-win-core-libraryloader-l1-2-0.dll
             1800286B0 Import Address Table
             18002F338 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 LoadLibraryExW
                          16 GetProcAddress
                          12 GetModuleHandleA
                           D FreeLibrary
                           1 DisableThreadLibraryCalls
                          18 LoadLibraryExA

    api-ms-win-core-localization-l1-2-0.dll
             1800286E8 Import Address Table
             18002F370 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          24 GetUserDefaultLangID
                           9 FormatMessageW

    api-ms-win-security-sddl-l1-1-0.dll
             1800289B0 Import Address Table
             18002F638 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ConvertSidToStringSidW

    RPCRT4.dll
             180028448 Import Address Table
             18002F0D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         215 RpcStringFreeW
                         21E UuidCreate
                         227 UuidToStringW

    api-ms-win-core-processenvironment-l1-1-0.dll
             180028700 Import Address Table
             18002F388 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B GetEnvironmentVariableW
                           0 ExpandEnvironmentStringsA

    api-ms-win-core-file-l1-1-0.dll
             180028608 Import Address Table
             18002F290 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B FindNextFileW
                           D FindClose
                           4 CreateDirectoryW
                          50 RemoveDirectoryW
                          2D GetFileAttributesW
                           A DeleteFileW
                          55 SetFileAttributesW
                          15 FindFirstFileW

    api-ms-win-core-string-l1-1-0.dll
             1800287D8 Import Address Table
             18002F460 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CompareStringEx
                           2 CompareStringW
                           6 MultiByteToWideChar

    api-ms-win-core-handle-l1-1-0.dll
             180028660 Import Address Table
             18002F2E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-service-management-l2-1-0.dll
             1800289F0 Import Address Table
             18002F678 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ChangeServiceConfig2W

    CRYPT32.dll
             180028218 Import Address Table
             18002EEA0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          C4 CryptProtectMemory
                          E2 CryptUnprotectMemory
                          E1 CryptUnprotectData
                          C3 CryptProtectData

    api-ms-win-core-sysinfo-l1-1-0.dll
             180028860 Import Address Table
             18002F4E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 GetComputerNameExW
                          1A GetTickCount
                           F GetSystemDirectoryW
                          16 GetSystemTimeAsFileTime
                          13 GetSystemTime
                          20 GetWindowsDirectoryW

    api-ms-win-service-winsvc-l1-1-0.dll
             180028A00 Import Address Table
             18002F688 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ControlService
                           A QueryServiceStatus

    api-ms-win-core-synch-l1-2-0.dll
             180028850 Import Address Table
             18002F4D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             180028898 Import Address Table
             18002F520 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 GetTraceEnableFlags
                           1 GetTraceEnableLevel
                           2 GetTraceLoggerHandle
                           6 TraceMessageVa
                           3 RegisterTraceGuidsW

    WS2_32.dll
             1800285D8 Import Address Table
             18002F260 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    14

    logoncli.dll
             180028A88 Import Address Table
             18002F710 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 DsGetDcNameW

    DNSAPI.dll
             180028240 Import Address Table
             18002EEC8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          CA DnsValidateName_W

    api-ms-win-core-file-l2-1-2.dll
             180028650 Import Address Table
             18002F2D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CopyFileW

    netutils.dll
             180028C00 Import Address Table
             18002F888 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 NetApiBufferFree

    api-ms-win-core-synch-l1-1-0.dll
             1800287F8 Import Address Table
             18002F480 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 EnterCriticalSection
                          1D LeaveCriticalSection
                          18 InitializeCriticalSection
                           3 CreateEventA
                           F DeleteCriticalSection
                           1 AcquireSRWLockShared
                          25 ReleaseSRWLockShared
                           0 AcquireSRWLockExclusive
                          24 ReleaseSRWLockExclusive
                          1B InitializeSRWLock

    api-ms-win-core-rtlsupport-l1-1-0.dll
             1800287B8 Import Address Table
             18002F440 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 RtlCaptureContext
                           B RtlLookupFunctionEntry
                          11 RtlVirtualUnwind

    api-ms-win-core-profile-l1-1-0.dll
             180028748 Import Address Table
             18002F3D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    bcrypt.dll
             180028A18 Import Address Table
             18002F6A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1D BCryptGenRandom
                           2 BCryptCloseAlgorithmProvider
                           D BCryptDestroyHash
                           6 BCryptCreateHash
                          27 BCryptOpenAlgorithmProvider
                          21 BCryptGetProperty
                          1B BCryptFinishHash
                          23 BCryptHashData

    api-ms-win-core-heap-l1-1-0.dll
             180028670 Import Address Table
             18002F2F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           2 HeapAlloc
                           0 GetProcessHeap

    certcli.dll
             180028A60 Import Address Table
             18002F6E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B CADeleteLocalAutoEnrollmentObject
                          14 CACreateLocalAutoEnrollmentObject

    LSASRV.dll
             180028280 Import Address Table
             18002EF08 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          38 LsaIFree_LSAPR_POLICY_INFORMATION
                          74 LsaIQueryInformationPolicyTrusted
                         10A LsarSetInformationPolicy
                          81 LsaISafeMode
                          FE LsarClose
                          71 LsaIOpenPolicyTrusted

    ADVAPI32.dll
             180028158 Import Address Table
             18002EDE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2CA ReportEventW
                         1DA LsaLookupSids
                         1D5 LsaLookupNames
                         2B8 RegisterEventSourceW
                          ED DeregisterEventSource
                         1DD LsaNtStatusToWinError
                         1C8 LsaFreeMemory
                          7D ConvertStringSDToSDDomainW
                         271 RegCreateKeyW
                         1E9 LsaQueryInformationPolicy
                         1DF LsaOpenPolicy
                         1B5 LsaClose
                         299 RegOpenKeyW
                         1F4 LsaSetInformationPolicy
                         26C RegCreateKeyA
                          61 ClearEventLogW
                         279 RegDeleteKeyW
                         2E2 SetEntriesInAclW
                          64 CloseEventLog
                         2ED SetNamedSecurityInfoW
                         157 GetNamedSecurityInfoW
                         1A5 LogonUserW
                         21E OpenEventLogW

    cryptdll.dll
             180028A78 Import Address Table
             18002F700 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 CDGenerateRandomBits

    KERNEL32.dll
             180028260 Import Address Table
             18002EEE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         404 MoveFileW
                         2C1 GetPrivateProfileStringW
                         1F1 GetComputerNameW

    ntdll.dll
             180028C10 Import Address Table
             18002F898 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         332 RtlConvertSidToUnicodeString
                         468 RtlIdentifierAuthoritySid
                         4E2 RtlLargeIntegerToChar
                         3C9 RtlEqualSid
                         1BD NtOpenThreadToken
                         101 NtClose
                         56B RtlReAllocateHeap
                         442 RtlGetNtProductType
                         255 NtSetInformationThread
                         1AA NtOpenKey
                         15B NtEnumerateKey
                         14B NtDeleteKey
                         4E6 RtlLengthSecurityDescriptor
                         1EF NtQueryKey
                          3D EtwEventUnregister
                         6EA WinSqmAddToStream
                         33F RtlCopySid
                         4E5 RtlLengthRequiredSid
                         5EA RtlSubAuthorityCountSid
                         5EB RtlSubAuthoritySid
                         497 RtlInitializeSid
                         63C RtlValidSid
                         513 RtlNtStatusToDosError
                         406 RtlFreeHeap
                         2DB RtlAllocateAndInitializeSid
                         481 RtlInitUnicodeString
                         2DE RtlAllocateHeap
                         4E7 RtlLengthSid
                          5B EvtIntReportEventAndSourceAsync
                          3B EtwEventRegister
                         6FB WinSqmIsOptedIn

    NTDSA.dll
             1800282B8 Import Address Table
             18002EF40 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          43 DsIsDCReadOnly
                          82 THClearErrors
                          59 GetConfigurationName
                          6E NameMatched
                          4F DsaDisableUpdates
                          17 DirErrorToWinError
                          87 THQuery
                          6F NameMatchedStringNameOnly
                          5A GetConfigurationNamesList
                           B DSInstanceFromSetupEx
                          83 THCreate
                          7F SampSetDsa
                          26 DirReplicaGetDemoteTarget
                          2C DirSearch
                          74 QuoteRDNValue
                          8D TrimDSNameBy
                          85 THFree
                          21 DirRead
                          4A DsUninitialize
                          50 DsaEnableUpdates
                          5F InitCommarg
                          40 DsInitialize
                           0 AppendRDN
                          84 THDestroy
                          4C DsUnloadDLL
                          81 THAlloc
                          5C GetRDNInfoExternal
                          45 DsLoadDLL
                          23 DirReplicaAdd
                          2B DirReplicaSynchronize
                           A DSInstanceFromNameEx
                          25 DirReplicaDemote
                          51 DsaSetInstallCallback
                          1B DirModifyEntry
                          13 DirAddEntry
                          2A DirReplicaSetCredentials
                           3 CountNameParts
                          86 THGetErrorString

    NTDSAPI.dll
             1800283F0 Import Address Table
             18002F078 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6C DsReplicaSyncW
                           D DsBindWithSpnExW
                          5B DsRemoveDsDomainW
                          39 DsInitDemotionW
                           A DsBindWithCredW
                          74 DsUnBindW
                           5 DsBindByInstanceW
                          63 DsReplicaDemotionW
                          5D DsRemoveDsServerW
                          1E DsFinishDemotionW

    SAMSRV.dll
             180028468 Import Address Table
             18002F0F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          5F SamIUnLoadDownlevelDatabase
                          45 SamIPromoteUndo
                          4F SamIReplaceDownlevelDatabase
                         123 SampUsingDsData
                          44 SamIPromote
                          13 SamIDemote
                          14 SamIDemoteUndo
                          39 SamILoadDownlevelDatabase

    SHLWAPI.dll
             1800284B0 Import Address Table
             18002F138 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6B PathIsRootW

  Summary

        2000 .data
        2000 .pdata
        A000 .rdata
        1000 .reloc
        1000 .rsrc
       27000 .text
