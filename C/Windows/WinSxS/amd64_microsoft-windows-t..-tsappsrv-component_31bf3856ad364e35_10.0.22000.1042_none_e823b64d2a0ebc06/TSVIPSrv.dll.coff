Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-t..-tsappsrv-component_31bf3856ad364e35_10.0.22000.1042_none_e823b64d2a0ebc06\TSVIPSrv.dll

File Type: DLL

  Image has the following dependencies:

    msvcp_win.dll
    api-ms-win-crt-time-l1-1-0.dll
    api-ms-win-crt-runtime-l1-1-0.dll
    api-ms-win-crt-private-l1-1-0.dll
    api-ms-win-crt-string-l1-1-0.dll
    dhcpcsvc.DLL
    ntdll.dll
    RPCRT4.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-eventing-provider-l1-1-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-debug-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    WS2_32.dll
    IPHLPAPI.DLL
    api-ms-win-core-threadpool-l1-2-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-psapi-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-1.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-synch-l1-2-1.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-io-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-security-base-l1-2-0.dll
    api-ms-win-core-processthreads-l1-1-1.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-interlocked-l1-1-0.dll
    KERNEL32.dll
    WINSTA.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-eventing-controller-l1-1-0.dll
    api-ms-win-security-lsalookup-l1-1-0.dll
    ADVAPI32.dll

  Section contains the following exports for TSVIPSrv.DLL

    00000000 characteristics
    94BE2169 time date stamp
        0.00 version
           1 ordinal base
           4 number of functions
           4 number of names

    ordinal hint RVA      name

          1    0 00005F00 OnSessionChange
          2    1 00005F70 Refresh
          3    2 00005FD0 StartComponent
          4    3 00006240 StopComponent

  Section contains the following imports:

    msvcp_win.dll
             180026D58 Import Address Table
             1800331F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         5B4 _Thrd_id
                         275 ?_Throw_Cpp_error@std@@YAXH@Z
                         274 ?_Throw_C_error@std@@YAXH@Z
                         551 _Cnd_register_at_thread_exit
                         5B5 _Thrd_join
                         589 _Mtx_unlock
                         585 _Mtx_lock
                         54B _Cnd_broadcast
                         554 _Cnd_unregister_at_thread_exit
                         295 ?__ExceptionPtrCopy@@YAXPEAXPEBX@Z
                         299 ?__ExceptionPtrDestroy@@YAXPEAX@Z
                         297 ?__ExceptionPtrCreate@@YAXPEAX@Z
                         28F ?_Xout_of_range@std@@YAXPEBD@Z
                         276 ?_Throw_future_error@std@@YAXAEBVerror_code@1@@Z
                         29C ?__ExceptionPtrToBool@@YA_NPEBX@Z
                         265 ?_Rethrow_future_exception@std@@YAXVexception_ptr@1@@Z
                         555 _Cnd_wait
                         54D _Cnd_destroy_in_situ
                         581 _Mtx_destroy_in_situ
                         550 _Cnd_init_in_situ
                         293 ?__ExceptionPtrAssign@@YAXPEAXPEBX@Z
                         296 ?__ExceptionPtrCopyException@@YAXPEAXPEBX1@Z
                         54E _Cnd_do_broadcast_at_thread_exit
                         28E ?_Xlength_error@std@@YAXPEBD@Z
                         584 _Mtx_init_in_situ
                         273 ?_Syserror_map@std@@YAPEBDH@Z

    api-ms-win-crt-time-l1-1-0.dll
             180026C28 Import Address Table
             1800330C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          30 _time64

    api-ms-win-crt-runtime-l1-1-0.dll
             180026BF8 Import Address Table
             180033098 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          36 _initterm
                          37 _initterm_e

    api-ms-win-crt-private-l1-1-0.dll
             180026AD0 Import Address Table
             180032F70 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         13C _o__initialize_narrow_environment
                         13D _o__initialize_onexit_table
                         13F _o__invalid_parameter_noinfo
                         140 _o__invalid_parameter_noinfo_noreturn
                         243 _o__purecall
                         251 _o__register_onexit_function
                         259 _o__seh_filter_dll
                         2CD _o__wcsicmp
                         464 memmove
                         310 _o__wmakepath_s
                         326 _o__wsplitpath_s
                         38D _o_free
                         3D8 _o_malloc
                         3E3 _o_memcpy_s
                         436 _o_terminate
                          12 __CxxFrameHandler3
                           1 _CxxThrowException
                          A7 _o__crt_atexit
                          A0 _o__configure_narrow_argv
                           C __C_specific_handler
                          2A __std_terminate
                          13 __CxxFrameHandler4
                          93 _o__cexit
                          91 _o__callnewh
                          8F _o__beginthreadex
                          C2 _o__execute_onexit_table
                          73 _o___stdio_common_vswscanf
                          C0 _o__errno
                          70 _o___stdio_common_vswprintf
                          6C _o___stdio_common_vsprintf
                          6A _o___stdio_common_vsnprintf_s
                          60 _o___std_type_info_destroy_list
                          5F _o___std_exception_destroy
                          5E _o___std_exception_copy
                         462 memcmp
                         463 memcpy

    api-ms-win-crt-string-l1-1-0.dll
             180026C10 Import Address Table
             1800330B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          82 memmove_s
                          83 memset

    dhcpcsvc.DLL
             180026D38 Import Address Table
             1800331D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          20 DhcpLeaseIpAddress
                          2D DhcpReleaseIpAddressLease
                          31 DhcpRenewIpAddressLease

    ntdll.dll
             180026E30 Import Address Table
             1800332D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         57E RtlReleaseResource
                         2B8 RtlAcquireResourceShared
                         2B7 RtlAcquireResourceExclusive
                         515 RtlNtStatusToDosError
                         301 RtlCaptureStackBackTrace
                         643 RtlVerifyVersionInfo
                         388 RtlDeleteResource
                         496 RtlInitializeResource
                          3D EtwEventUnregister
                          3B EtwEventRegister
                          41 EtwEventWriteFull
                         40B RtlFreeSid
                         203 NtQuerySystemTime
                         4B0 RtlIpv4AddressToStringW
                         518 RtlNumberGenericTableElements
                         6E8 VerSetConditionMask
                         3C1 RtlEnumerateGenericTable
                         4FA RtlLookupElementGenericTable
                         49B RtlInsertElementGenericTable
                         491 RtlInitializeGenericTable
                         380 RtlDeleteElementGenericTable
                         2FF RtlCaptureContext
                         500 RtlLookupFunctionEntry
                         2DC RtlAllocateAndInitializeSid
                         644 RtlVirtualUnwind
                          22 DbgPrint
                         201 NtQuerySystemInformation

    RPCRT4.dll
             1800266C8 Import Address Table
             180032B68 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F I_RpcBindingInqLocalClientPID
                          50 I_RpcOpenClientProcess
                         1CB RpcRevertToSelf
                         1A7 RpcImpersonateClient
                         1D2 RpcServerInqCallAttributesW
                         213 RpcStringBindingParseW
                         18B RpcBindingToStringBindingW
                         1E6 RpcServerUnregisterIfEx
                         215 RpcStringFreeW
                         1DE RpcServerRegisterAuthInfoW
                         1D4 RpcServerInqDefaultPrincNameW
                         1E2 RpcServerRegisterIfEx
                         1F0 RpcServerUseProtseqEpW
                         1DC RpcServerListen
                         131 NdrServerCall2
                         132 NdrServerCallAll

    api-ms-win-core-heap-l2-1-0.dll
             180026850 Import Address Table
             180032CF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree
                           2 LocalAlloc

    api-ms-win-core-processenvironment-l1-1-0.dll
             1800268F0 Import Address Table
             180032D90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ExpandEnvironmentStringsW

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800267E8 Import Address Table
             180032C88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F SetUnhandledExceptionFilter
                          11 UnhandledExceptionFilter
                           5 GetLastError
                           D SetLastError

    api-ms-win-eventing-provider-l1-1-0.dll
             180026C58 Import Address Table
             1800330F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 EventActivityIdControl
                           5 EventUnregister
                           3 EventRegister
                           4 EventSetInformation
                           9 EventWriteTransfer

    api-ms-win-core-localization-l1-2-0.dll
             1800268E0 Import Address Table
             180032D80 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 FormatMessageW

    api-ms-win-core-processthreads-l1-1-0.dll
             180026900 Import Address Table
             180032DA0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D GetCurrentProcessId
                          10 GetCurrentThread
                          11 GetCurrentThreadId
                          34 OpenProcessToken
                           3 CreateProcessW
                           C GetCurrentProcess
                          55 TerminateProcess
                           6 CreateThread
                          37 ProcessIdToSessionId
                          36 OpenThreadToken
                          1A GetProcessId

    api-ms-win-core-heap-l1-1-0.dll
             180026830 Import Address Table
             180032CD0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           0 GetProcessHeap
                           2 HeapAlloc

    api-ms-win-core-libraryloader-l1-2-0.dll
             180026890 Import Address Table
             180032D30 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 GetModuleHandleExW
                           1 DisableThreadLibraryCalls
                          16 GetProcAddress
                           D FreeLibrary
                          10 GetModuleFileNameA
                          1D LoadStringW
                          15 GetModuleHandleW

    api-ms-win-core-debug-l1-1-0.dll
             1800267C0 Import Address Table
             180032C60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 IsDebuggerPresent
                           4 DebugBreak
                           7 OutputDebugStringW
                           6 OutputDebugStringA

    api-ms-win-core-handle-l1-1-0.dll
             180026820 Import Address Table
             180032CC0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    WS2_32.dll
             180026780 Import Address Table
             180032C20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   115
                             Ordinal   116
                          14 WSAAddressToStringW
                             Ordinal   111
                             Ordinal    14
                           A InetNtopW
                             Ordinal     8

    IPHLPAPI.DLL
             180026618 Import Address Table
             180032AB8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          59 GetIfTable2
                          2D CreateUnicastIpAddressEntry
                          18 ConvertIpv4MaskToLength
                          38 DeleteUnicastIpAddressEntry
                          63 GetIpAddrTable
                          40 FreeMibTable
                          94 GetUnicastIpAddressEntry
                          A3 InitializeUnicastIpAddressEntry
                           5 CancelMibChangeNotify2
                          19 ConvertLengthToIpv4Mask
                          F7 NotifyIpInterfaceChange
                          43 GetAdaptersAddresses
                          55 GetIfEntry2

    api-ms-win-core-threadpool-l1-2-0.dll
             180026AA0 Import Address Table
             180032F40 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          20 TrySubmitThreadpoolCallback
                           6 CloseThreadpoolTimer
                          1A SetThreadpoolTimer
                           C CreateThreadpoolTimer
                          22 WaitForThreadpoolTimerCallbacks

    api-ms-win-core-synch-l1-2-0.dll
             180026A58 Import Address Table
             180032EF8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-security-base-l1-1-0.dll
             180026C88 Import Address Table
             180033128 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 AllocateAndInitializeSid
                          23 CreateWellKnownSid
                          1B CheckTokenMembership
                          28 DuplicateToken
                          42 GetTokenInformation
                          2C EqualSid
                          40 GetSidSubAuthority
                          41 GetSidSubAuthorityCount

    api-ms-win-core-psapi-l1-1-0.dll
             180026988 Import Address Table
             180032E28 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 QueryFullProcessImageNameW

    api-ms-win-core-libraryloader-l1-2-1.dll
             1800268D0 Import Address Table
             180032D70 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1A LoadLibraryW

    api-ms-win-core-synch-l1-1-0.dll
             1800269C0 Import Address Table
             180032E60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AcquireSRWLockExclusive
                          24 ReleaseSRWLockExclusive
                           B CreateSemaphoreExW
                           9 CreateMutexExW
                          21 OpenSemaphoreW
                          37 WaitForSingleObjectEx
                          23 ReleaseMutex
                          36 WaitForSingleObject
                          29 SetEvent
                           1 AcquireSRWLockShared
                           6 CreateEventW
                          1A InitializeCriticalSectionEx
                          26 ReleaseSemaphore
                          19 InitializeCriticalSectionAndSpinCount
                          1D LeaveCriticalSection
                          11 EnterCriticalSection
                           F DeleteCriticalSection
                          25 ReleaseSRWLockShared

    api-ms-win-core-synch-l1-2-1.dll
             180026A68 Import Address Table
             180032F08 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C CreateSemaphoreW
                          34 WaitForMultipleObjects

    api-ms-win-service-management-l1-1-0.dll
             180026D00 Import Address Table
             1800331A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseServiceHandle
                           6 StartServiceW
                           5 OpenServiceW
                           4 OpenSCManagerW

    api-ms-win-core-file-l1-1-0.dll
             180026810 Import Address Table
             180032CB0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 CreateFileW

    api-ms-win-core-io-l1-1-0.dll
             180026878 Import Address Table
             180032D18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DeviceIoControl
                           5 GetOverlappedResult

    api-ms-win-service-winsvc-l1-1-0.dll
             180026D28 Import Address Table
             1800331C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ControlService

    api-ms-win-security-base-l1-2-0.dll
             180026CD0 Import Address Table
             180033170 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1C CheckTokenMembershipEx

    api-ms-win-core-processthreads-l1-1-1.dll
             180026960 Import Address Table
             180032E00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          32 IsProcessorFeaturePresent
                          33 OpenProcess

    api-ms-win-core-profile-l1-1-0.dll
             180026978 Import Address Table
             180032E18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-core-sysinfo-l1-1-0.dll
             180026A80 Import Address Table
             180032F20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 GetSystemTimeAsFileTime
                           F GetSystemDirectoryW
                          13 GetSystemTime

    api-ms-win-core-interlocked-l1-1-0.dll
             180026868 Import Address Table
             180032D08 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 InitializeSListHead

    KERNEL32.dll
             180026688 Import Address Table
             180032B28 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         124 DeleteTimerQueueEx
                          80 ChangeTimerQueueTimer
                         662 lstrcmpiW
                         102 CreateTimerQueue
                         103 CreateTimerQueueTimer
                         125 DeleteTimerQueueTimer
                         470 QueueUserWorkItem

    WINSTA.dll
             180026750 Import Address Table
             180032BF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          66 WinStationQueryInformationW
                          32 WinStationFreePropertyValue
                          3D WinStationGetConnectionProperty
                          80 WinStationSendMessageW
                          7D WinStationReset

    api-ms-win-core-registry-l1-1-0.dll
             180026998 Import Address Table
             180032E38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2E RegSetValueExW
                          25 RegQueryValueExW
                           0 RegCloseKey
                          1E RegOpenKeyExW

    api-ms-win-security-sddl-l1-1-0.dll
             180026CF0 Import Address Table
             180033190 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConvertStringSidToSidW

    api-ms-win-eventing-controller-l1-1-0.dll
             180026C38 Import Address Table
             1800330D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 StartTraceW
                           1 EnableTraceEx2
                           0 ControlTraceW

    api-ms-win-security-lsalookup-l1-1-0.dll
             180026CE0 Import Address Table
             180033180 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 LookupAccountSidLocalW

    ADVAPI32.dll
             1800265F8 Import Address Table
             180032A98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2CD ReportEventW
                          ED DeregisterEventSource
                         2BB RegisterEventSourceW

  Summary

        4000 .data
        2000 .pdata
       10000 .rdata
        1000 .reloc
        2000 .rsrc
       24000 .text
