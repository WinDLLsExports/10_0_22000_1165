Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-pnpsysprep_31bf3856ad364e35_10.0.22000.1_none_98011922bbdb7298\sppnp.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    USER32.dll
    CFGMGR32.dll
    SETUPAPI.dll
    newdev.dll
    OLEAUT32.dll
    wevtapi.dll
    WDSCORE.dll
    drvstore.dll
    ServicingCommon.dll
    api-ms-win-devices-query-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-1.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-eventing-provider-l1-1-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-service-core-l1-1-2.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-file-l2-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    api-ms-win-security-provider-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-io-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    KERNEL32.dll
    api-ms-win-core-com-l1-1-0.dll
    GDI32.dll

  Section contains the following exports for sppnp.dll

    00000000 characteristics
    FFDC4861 time date stamp
        0.00 version
           1 ordinal base
           6 number of functions
           6 number of names

    ordinal hint RVA      name

          1    0 00009C30 Sysprep_Generalize_Pnp
          2    1 0000A2F0 Sysprep_Generalize_Pnp_Drivers
          3    2 0000A550 Sysprep_Respecialize_Pnp
          4    3 00017370 Sysprep_RunDll_PnpW
          5    4 0000AD30 Sysprep_Specialize_Offline_Pnp
          6    5 0000BE20 Sysprep_Specialize_Pnp

  Section contains the following imports:

    msvcrt.dll
             18002FE98 Import Address Table
             18003E5B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         376 _vsnwprintf
                         2B4 _resetstkoflw
                         370 _vsnprintf
                         4F7 toupper
                         50E wcschr
                          62 __CxxFrameHandler3
                          34 ?terminate@@YAXXZ
                         51A wcsncpy_s
                         512 wcscpy_s
                         49F memcpy
                         4A1 memmove
                         29C _onexit
                          84 __dllonexit
                         34E _unlock
                         1F2 _lock
                         189 _initterm
                          B7 _amsg_exit
                          5A _XcptFilter
                         459 free
                          C8 _callnewh
                         493 malloc
                         4EA swscanf
                          5E __C_specific_handler
                         51D wcsrchr
                         3A1 _wcsnicmp
                         47C iswalpha
                         4B1 qsort
                         4EB swscanf_s
                         397 _wcsicmp
                         4A3 memset

    ntdll.dll
             18002FFA8 Import Address Table
             18003E6C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         406 RtlFreeHeap
                         2DE RtlAllocateHeap
                         14E NtDeleteValueKey
                         26E NtSetValueKey
                         206 NtQueryValueKey
                         120 NtCreateKey
                         1AA NtOpenKey
                         40D RtlFreeUnicodeString
                         505 RtlMultiByteToUnicodeN
                         506 RtlMultiByteToUnicodeSize
                         616 RtlUnicodeToMultiByteN
                         617 RtlUnicodeToMultiByteSize
                         24E NtSetInformationFile
                         1E1 NtQueryInformationFile
                         463 RtlGetVersion
                         14B NtDeleteKey
                         400 RtlFormatCurrentUserKeyPath
                         514 RtlNtStatusToDosErrorNoTeb
                         642 RtlVirtualUnwind
                         4FE RtlLookupFunctionEntry
                         2FE RtlCaptureContext
                         513 RtlNtStatusToDosError
                         481 RtlInitUnicodeString
                         28A NtUnloadKeyEx
                         201 NtQuerySystemInformation
                         482 RtlInitUnicodeStringEx
                         101 NtClose
                         209 NtQueryWnfStateData
                         1AB NtOpenKeyEx

    USER32.dll
             18002F760 Import Address Table
             18003DE78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          76 CreateWindowExW
                         1B2 GetPropW
                         37E SetWindowPos
                         24D IsWindowVisible
                         142 GetDC
                          B5 DestroyWindow
                         318 SendMessageW
                          A7 DefWindowProcW
                         18A GetMessageW
                         1EA GetWindowLongW
                         110 FillRect
                         254 LoadBitmapW
                         267 LoadStringW
                         1C8 GetSystemMetrics
                         383 SetWindowTextW
                         113 FindWindowExW
                         321 SetClassLongPtrW
                         294 NotifyWinEvent
                         2DE RegisterClassExW
                         36A SetThreadDesktop
                         392 ShowWindow
                          BD DispatchMessageW
                         36E SetTimer
                         27E MapWindowPoints
                         337 SetFocus
                         35B SetPropW
                         3B2 TranslateMessage
                         1F8 GetWindowTextW
                          F4 EndPaint
                          11 BeginPaint
                         2FC ReleaseDC
                         223 InvalidateRect
                         25C LoadImageW
                         3CC UpdateWindow
                         2AE PostQuitMessage
                         250 KillTimer
                          DE DrawTextW
                         133 GetClientRect
                         328 SetCursor

    CFGMGR32.dll
             18002F4D0 Import Address Table
             18003DBE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 CMP_GetServerSideDeviceInstallFlags
                          5F CM_Get_DevNode_Status
                           6 CMP_WaitNoPendingInstallEvents
                          AD CM_MapCrToWin32Err
                          C9 CM_Reenumerate_DevNode

    SETUPAPI.dll
             18002F650 Import Address Table
             18003DD68 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         154 SetupDiGetClassDevsW
                         251 SetupVerifyInfFileW
                         1B1 SetupDiSetDeviceRegistryPropertyW
                         172 SetupDiGetDeviceRegistryPropertyW
                         24F SetupUninstallOEMInfW
                         1D6 SetupGetInfPublishedNameW
                         140 SetupDiEnumDeviceInfo
                         193 SetupDiOpenDeviceInfoW
                         130 SetupDiCreateDeviceInfoList
                         199 SetupDiRemoveDevice
                         122 SetupDiCallClassInstaller
                         165 SetupDiGetDeviceInfoListDetailW
                         153 SetupDiGetClassDevsExW
                         167 SetupDiGetDeviceInstallParamsW
                         169 SetupDiGetDeviceInstanceIdW
                         1AC SetupDiSetDeviceInstallParamsW
                         1D0 SetupGetInfDriverStoreLocationW
                         253 SetupWriteTextLogError
                         252 SetupWriteTextLog
                          F4 PnpEnumDrpFile
                          F8 PnpRepairWindowsProtectedDriver
                         27A pSetupInfGetDigitalSignatureInfo
                         27C pSetupInfSetDigitalSignatureInfo
                         27B pSetupInfIsInbox
                         26D pSetupFree
                         245 SetupSetNonInteractiveMode
                         1EC SetupGetThreadLogToken
                         13D SetupDiDestroyDeviceInfoList
                         170 SetupDiGetDevicePropertyW
                         24A SetupSetThreadLogToken

    newdev.dll
             18002FF90 Import Address Table
             18003E6A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DiInstallDevice
                           3 DiInstallDriverW

    OLEAUT32.dll
             18002F638 Import Address Table
             18003DD50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     2
                             Ordinal     6

    wevtapi.dll
             180030098 Import Address Table
             18003E7B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 EvtClearLog

    WDSCORE.dll
             18002F8A0 Import Address Table
             18003DFB8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          37 WdsInitialize
                          5B WdsTerminate
                          59 WdsSetupLogMessageW
                           3 ConstructPartialMsgVW
                           4 CurrentIP

    drvstore.dll
             18002FE30 Import Address Table
             18003E548 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 DriverPackageOpenW
                          29 DriverStoreOpenW
                          1B DriverStoreEnumW
                          2F DriverStoreSetLogContext
                          2B DriverStoreReflectCriticalW
                          10 DriverPackageGetVersionInfoW
                          17 DriverStoreEnumDeviceDriversW
                           0 DriverPackageClose
                          12 DriverStoreClose
                          1C DriverStoreFindW
                          30 DriverStoreSetObjectPropertyW
                          1E DriverStoreGetObjectPropertyW

    ServicingCommon.dll
             18002F748 Import Address Table
             18003DE60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          21 RemoveFileProtection
                          17 GetLoadedHiveKeyName

    api-ms-win-devices-query-l1-1-0.dll
             18002FD00 Import Address Table
             18003E418 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C DevGetObjects
                           9 DevFreeObjects
                           E DevSetObjectProperties

    api-ms-win-core-registry-l1-1-0.dll
             18002FB98 Import Address Table
             18003E2B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1E RegOpenKeyExW
                          2C RegSetValueExW
                           9 RegDeleteTreeW
                           B RegDeleteValueW
                          23 RegQueryValueExW
                           E RegEnumKeyExW
                           5 RegDeleteKeyExW
                           0 RegCloseKey
                          1B RegNotifyChangeKeyValue
                          18 RegLoadKeyW
                          2E RegUnLoadKeyW
                           3 RegCreateKeyExW

    api-ms-win-core-processthreads-l1-1-0.dll
             18002FB00 Import Address Table
             18003E218 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          4A SetThreadToken
                          33 OpenThreadToken
                          10 GetCurrentThread
                          31 OpenProcessToken
                           C GetCurrentProcess
                          14 GetExitCodeThread
                           6 CreateThread
                          37 QueueUserAPC
                           8 ExitProcess
                           3 CreateProcessW
                          13 GetExitCodeProcess
                          4D TerminateProcess
                           D GetCurrentProcessId
                          11 GetCurrentThreadId

    api-ms-win-core-processthreads-l1-1-1.dll
             18002FB78 Import Address Table
             18003E290 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          30 OpenProcess

    api-ms-win-security-base-l1-1-0.dll
             18002FD78 Import Address Table
             18003E490 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          33 GetKernelObjectSecurity
                          37 GetSecurityDescriptorDacl
                          38 GetSecurityDescriptorGroup
                          3A GetSecurityDescriptorOwner
                          4B IsValidSecurityDescriptor
                          28 DuplicateTokenEx
                          15 AdjustTokenPrivileges

    api-ms-win-eventing-provider-l1-1-0.dll
             18002FD58 Import Address Table
             18003E470 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 EventRegister
                           5 EventUnregister
                           9 EventWriteTransfer

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             18002FD20 Import Address Table
             18003E438 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 RegisterTraceGuidsW
                           4 TraceEvent
                           0 GetTraceEnableFlags
                           2 GetTraceLoggerHandle
                           7 UnregisterTraceGuids
                           1 GetTraceEnableLevel

    api-ms-win-service-management-l1-1-0.dll
             18002FDF8 Import Address Table
             18003E510 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseServiceHandle
                           6 StartServiceW
                           4 OpenSCManagerW
                           5 OpenServiceW

    api-ms-win-security-sddl-l1-1-0.dll
             18002FDD8 Import Address Table
             18003E4F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW

    api-ms-win-service-core-l1-1-2.dll
             18002FDE8 Import Address Table
             18003E500 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 GetServiceKeyNameW

    api-ms-win-service-winsvc-l1-1-0.dll
             18002FE20 Import Address Table
             18003E538 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A QueryServiceStatus

    api-ms-win-core-errorhandling-l1-1-0.dll
             18002F8F0 Import Address Table
             18003E008 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 GetLastError
                          11 UnhandledExceptionFilter
                           F SetUnhandledExceptionFilter
                           7 RaiseException
                           C SetErrorMode
                           D SetLastError

    api-ms-win-core-string-l1-1-0.dll
             18002FC00 Import Address Table
             18003E318 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 WideCharToMultiByte
                           2 CompareStringW
                           1 CompareStringOrdinal

    api-ms-win-core-synch-l1-1-0.dll
             18002FC20 Import Address Table
             18003E338 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F DeleteCriticalSection
                           0 AcquireSRWLockExclusive
                          29 SetEvent
                          18 InitializeCriticalSection
                          1D LeaveCriticalSection
                          11 EnterCriticalSection
                           6 CreateEventW
                          23 ReleaseMutex
                          37 WaitForSingleObjectEx
                          1F OpenEventW
                          35 WaitForMultipleObjectsEx
                          27 ResetEvent
                          30 SleepEx
                          36 WaitForSingleObject
                          24 ReleaseSRWLockExclusive
                           A CreateMutexW

    api-ms-win-core-synch-l1-2-0.dll
             18002FCA8 Import Address Table
             18003E3C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2F SleepConditionVariableSRW
                          2D Sleep
                          39 WakeAllConditionVariable

    api-ms-win-core-handle-l1-1-0.dll
             18002F9D0 Import Address Table
             18003E0E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-processenvironment-l1-1-0.dll
             18002FAE0 Import Address Table
             18003E1F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 GetCommandLineA
                           B GetEnvironmentVariableW
                           1 ExpandEnvironmentStringsW

    api-ms-win-core-heap-l1-1-0.dll
             18002F9E0 Import Address Table
             18003E0F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           9 HeapReAlloc
                           0 GetProcessHeap
                           2 HeapAlloc

    api-ms-win-core-file-l1-1-0.dll
             18002F928 Import Address Table
             18003E040 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          4C SetEndOfFile
                           6 CreateFileW
                          50 SetFileAttributesW
                          2B GetFileInformationByHandle
                          53 SetFilePointer
                          1E FlushFileBuffers
                          2C GetFileSize
                          59 WriteFile
                           B FileTimeToLocalFileTime
                          33 GetFullPathNameW
                           9 DeleteFileW
                          2A GetFileAttributesW
                          1A FindNextFileW
                          14 FindFirstFileW
                           1 CompareFileTime
                           C FindClose
                           3 CreateDirectoryW

    api-ms-win-core-file-l2-1-0.dll
             18002F9B8 Import Address Table
             18003E0D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 MoveFileExW
                           5 CreateHardLinkW

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             18002FA18 Import Address Table
             18003E130 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1D FindResourceW
                          45 MulDiv
                          3E LoadLibraryW

    api-ms-win-security-provider-l1-1-0.dll
             18002FDC8 Import Address Table
             18003E4E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 SetNamedSecurityInfoW

    api-ms-win-security-lsalookup-l2-1-0.dll
             18002FDB8 Import Address Table
             18003E4D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW

    api-ms-win-core-libraryloader-l1-2-0.dll
             18002FA38 Import Address Table
             18003E150 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1A LoadResource
                          1D LockResource
                          13 GetModuleHandleExW
                          15 GetProcAddress
                           C FreeLibrary
                          18 LoadLibraryExW
                          14 GetModuleHandleW
                          10 GetModuleFileNameW
                           F GetModuleFileNameA
                          20 SizeofResource

    api-ms-win-core-localization-l1-2-0.dll
             18002FA90 Import Address Table
             18003E1A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          32 LCMapStringW
                          1C GetThreadLocale
                          12 GetLocaleInfoEx
                           8 FormatMessageW
                          13 GetLocaleInfoW

    api-ms-win-core-memory-l1-1-0.dll
             18002FAC0 Import Address Table
             18003E1D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          21 UnmapViewOfFile
                           4 CreateFileMappingW
                          10 MapViewOfFile

    api-ms-win-core-sysinfo-l1-1-0.dll
             18002FCC8 Import Address Table
             18003E3E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1C GetVersionExW
                           5 GetLocalTime
                          18 GetTickCount
                          14 GetSystemTimeAsFileTime
                          17 GetSystemWindowsDirectoryW
                          19 GetTickCount64

    api-ms-win-core-io-l1-1-0.dll
             18002FA08 Import Address Table
             18003E120 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DeviceIoControl

    api-ms-win-core-profile-l1-1-0.dll
             18002FB88 Import Address Table
             18003E2A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    KERNEL32.dll
             18002F600 Import Address Table
             18003DD18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         17C FileTimeToSystemTime
                         45E QueryFullProcessImageNameW
                         3E8 LocalFree
                         3B2 K32EnumProcesses
                         2F6 GetSystemDefaultUILanguage
                         397 IsDebuggerPresent

    api-ms-win-core-com-l1-1-0.dll
             18002F8D0 Import Address Table
             18003DFE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          28 CoInitializeEx
                           9 CoCreateInstance
                          44 CoUninitialize

    GDI32.dll
             18002F500 Import Address Table
             18003DC18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          13 BitBlt
                         373 SetBrushOrgEx
                          30 CreateCompatibleBitmap
                         368 SelectObject
                          31 CreateCompatibleDC
                         3A4 StretchBlt
                         2C2 GetStockObject
                         27F GetDeviceCaps
                         185 DeleteDC
                         2D3 GetTextExtentPoint32W
                         397 SetTextColor
                         370 SetBkMode
                         39F SetWorldTransform
                         36F SetBkColor
                         393 SetStretchBltMode
                         188 DeleteObject
                          5A CreateSolidBrush
                         327 RemoveFontMemResourceEx
                          43 CreateFontIndirectW
                         395 SetTextAlign
                         1F0 GdiAlphaBlend
                           2 AddFontMemResourceEx
                          38 CreateDIBitmap
                         2DB GetTextMetricsW
                         37E SetGraphicsMode
                         382 SetLayout
                         2C9 GetTextAlign
                         3AA TextOutW
                         396 SetTextCharacterExtra
                         2B1 GetObjectW
                         385 SetMapMode

  Summary

        1000 .data
        2000 .pdata
       12000 .rdata
        1000 .reloc
        1000 .rsrc
       2E000 .text
